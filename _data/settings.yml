#-------------------------------
# General Site Settings

menu:
- {name: 'About', url: ''}
- {name: 'Research', url: 'pages/research.html'}
- {name: 'Software', url: 'pages/software.html'}
#- {name: 'Projects', url: 'pages/projects.html'}
- {name: 'Contact', url: 'pages/contact.html'}

#-------------------------------
# SEO Section

# NOTE: Providing SEO information will make this website more searchable on the internet.

seo:
  description: 'Carlos Mastalli is a robotics research focused on multi-contact planning and control for legged robots. He is main motivation is to enable robots (e.g. HyQ, HRP-2, Talos, Atlas) to move everywhere by combining optimal control and machine learning.'
  rel-author: 'Carlos Mastalli'
  rel-publisher: 'Carlos Mastalli'

#-------------------------------
# Google Analytics Section

# Analytics helps you understand who visits your website.
# Learn more at: http://support.google.com/analytics/answer/1008065

# NOTE: If you want to use Google Analytics for basic web tracking: Just uncomment and enter your UA-Code here.

google-analytics-ua: 'UA-113566398-1'

#-------------------------------
# Disqus Section

# Change to true for Disqus comments
disqus:
  comments: false
  disqus_shortname: ''

#-------------------------------
# About Section

about: >
  ## About Me - [CV](/personal/cmastalli_cv.pdf)

  <img src="/assets/img/carlos_mastalli.jpeg" alt="Drawing" style="width: 200px;"/>
  <img src="https://i.imgur.com/RKe3sNo.gif" align="right" alt="Drawing" style="height: 200px;"/>

  <p class="lead" style="font-variant:small-caps">
      Optimal Control - Motion Planning - Trajectory Optimization<br />
      Reinforcement Learning - Legged Robots - Perception
  </p>

  I am a robotics researcher in the [Gepetto Team](http://projects.laas.fr/gepetto/) at LAAS-CNRS working on the topic of multi-contact planning and control in legged robots. My main motivation is to enable robots to move everywhere. In particular, I am focused on legged locomotion since it combines all the main challenges in robot mobility: high-dimensional and unactuated systems, discontinuous dynamics, robot interaction and perception. For that, I am interested in methods that combine optimal control and machine learning, allowing us to explore the knowledge of the system but also the vast robot's data.
  
    
  I completed my PhD on ["Planning and Execution of Dynamic Whole-Body Locomotion on Challenging Terrain"](/publications/cmastalli_thesis.pdf) in April 2017 in the [Dynamic Legged System lab](https://dls.iit.it/) at Istituto Italiano di Tecnologia. After that, I served as Research Fellow from April to December 2017. During this period, I mainly contributed to planning, perception and control framework for legged locomotion on challenging terrain. He also considerably contributed to the software development of the team.


#-------------------------------
# Research Section

research: >
  ## Research


  #### [Motion planning for quadrupedal locomotion: coupled planning, terrain mapping and whole-body control (under-review)](/publications/locomotion17unpub.pdf)
  
  <iframe class="embed-responsive-item" allowfullscreen="allowfullscreen"
    width="420" height="237"
    src="https://youtube.com/embed/KI9x1GZWRwE"
    style="float: right; "
    marginwidth="10">
  </iframe>


  Legged robots promise an advantage over traditional wheeled systems as they can offer greater mobility on challenging terrain. However, most legged robots are still confined to structured and flat environments. One of the main reasons for this is the difficulty in planning complex whole-body motions while taking into account the terrain conditions. Previous research in locomotion mainly focused either on generating reactive behaviors, that tackle only small terrain changes, or on kinematically planning foothold locations with partial terrain information. Alternatively, legged motion planning approaches focus on synthesizing complex whole-body motions, but often do not consider terrain characteristics. This problem is very high-dimensional as it considers the robot's dynamics together with the terrain model in a suitable problem formulation. In this work, we address these challenges by studying two different motion planning methods (decoupled and coupled foothold and motion planning), and by analyzing the effect of considering friction cones, kinematic limits and torque limits at the whole-body control level. For that, we first briefly introduce our decoupled motion planning approach. Second, we propose a novel trajectory and foothold optimization method that plans dynamically both foothold locations and CoM motions (coupled planning). This second method jointly optimizes body motion, step duration and foothold selection, considering the terrain topology. Finally, we introduce a whole-body controller that tracks compliantly trunk motions while avoiding slippage as well as kinematic and torque limits. Additionally, we impose friction cone constraints in real-time using terrain normals estimated from the terrain map. With this novel locomotion framework we can cross a wide range of terrain conditions—significantly more compared our previous approach—while we validate our novel framework on the hydraulic quadruped robot; HyQ. Additionally, our coupled motion planner can be easily generalize to various terrain conditions, thanks to a parametrized dynamic model, and an online terrain mapping that is used in our real-time whole-body controller. We report thorough experimental results and comparative evaluations over a set of terrains of progressively increasing difficulty.

  <a href="/publications/locomotion17unpub.pdf">
    <img src="/assets/img/download.png" alt="Drawing" style="height: 20px;"/>
  </a>
  <a href="/publications/bibtex/locomotion17unpub.bib">
    <img src="/assets/img/bibtex.jpeg" alt="Drawing" style="height: 20px;"/>
  </a>


  
  #### [Simultaneous Contact, Gait and Motion Planning for Robust Multi-Legged Locomotion via Mixed-Integer Convex Optimization (RAL)](/publications/gait17ral.pdf)
  
  <iframe class="embed-responsive-item" allowfullscreen="allowfullscreen"
    width="420" height="237"
    src="https://youtube.com/embed/RXIAQJx5938"
    style="float: right; "
    marginwidth="10">
  </iframe>


  Traditional motion planning approaches for multi-legged locomotion divide the problem into several stages, such as contact search and trajectory generation. However, reasoning about contacts and motions simultaneously is crucial for the generation of complex whole-body behaviors. Currently, coupling theses problems has required either the assumption of a fixed gait sequence and flat terrain condition, or non-convex optimization with intractable computation time. In this paper, we propose a mixed-integer convex formulation to plan simultaneously contact locations, gait transitions and motion, in a computationally efficient fashion. In contrast to previous works, our approach is not limited to flat terrain nor to a pre-specified gait sequence. Instead, we incorporate the friction cone stability margin, approximate the robot's torque limits, and plan the gait using mixed-integer convex constraints. We experimentally validated our approach on the HyQ robot by traversing different challenging terrains, where non-convexity and flat terrain assumptions might lead to sub-optimal or unstable plans. Our method increases the motion generality while keeping a low computation time.

  <a href="/publications/gait17ral.pdf">
    <img src="/assets/img/download.png" alt="Drawing" style="height: 20px;"/>
  </a>
  <a href="/publications/bibtex/gait17ral.bib">
    <img src="/assets/img/bibtex.jpeg" alt="Drawing" style="height: 20px;"/>
  </a>



  #### [A Feasibility Metric for Trajectory Optimization of Legged Robots using Wrench Polytopes (under-review)](/publications/feasibility18unpub.pdf)
  
  <iframe class="embed-responsive-item" allowfullscreen="allowfullscreen"
    width="420" height="237"
    src="https://youtube.com/embed/X36PLdTNr6U"
    style="float: right; "
    marginwidth="10">
  </iframe>


  Motion planning in multi-contact scenarios has recently gathered interest within the legged robotics community, however actuator force/torque limits are rarely considered. We believe that these limits gain paramount importance when the complexity of the terrains to be traversed increases. For this reason we propose two new six-dimensional bounded polytopes named the Actuation Wrench Polytope (AWP) and the Feasible Wrench Polytope (FWP). We define the AWP as the set of all the wrenches that a robot can generate on its own Center of Mass (CoM) while considering its actuation limits. This considers the admissible contact forces that the robot can generate given its current configuration and actuation capabilities but does not include features of the environment such as the contact normal or the friction coefficient. These are considered by the Contact Wrench Cone (CWC); the AWP can therefore be seen as complementary with respect to the CWC. The intersection of the AWP and of the CWC results in a polytope, the FWP, which turns out to be more descriptive of the real robot capabilities, while maintaining the same compact representation. We explain how to efficiently compute the vertex-description of the FWP and we also introduce a new locomotion stability metric based on the FWP, that we call feasibility margin, which allows us to optimize for robustness to external disturbance wrenches. Based on this, we present an implementation of a motion planner for our quadruped robot HyQ that provides online CoM trajectories that are guaranteed to be stable and actuation-consistent. 

  <a href="/publications/feasibility18unpub.pdf">
    <img src="/assets/img/download.png" alt="Drawing" style="height: 20px;"/>
  </a>
  <a href="/publications/bibtex/feasibility18unpub.bib">
    <img src="/assets/img/bibtex.jpeg" alt="Drawing" style="height: 20px;"/>
  </a>


  #### [Trajectory and Foothold Optimization using Low-Dimensional Models for Rough Terrain Locomotion (ICRA)](/publications/coupled17icra.pdf)
  
  <iframe class="embed-responsive-item" allowfullscreen="allowfullscreen"
    width="420" height="237"
    src="https://youtube.com/embed/79bb2KTULrw"
    style="float: right; "
    marginwidth="10">
  </iframe>


  We present a trajectory optimization framework for legged locomotion on rough terrain. We jointly optimize the center of mass motion and the foothold locations, while considering terrain conditions. We use a terrain costmap to quantify the desirability of a foothold location. We increase the gait's adaptability to the terrain by optimizing the step phase duration and modulating the trunk attitude, resulting in motions with guaranteed stability. We show that the combination of parametric models, stochastic-based exploration and receding horizon planning allows us to handle the many local minima associated with different terrain conditions and walking patterns. This combination delivers robust motion plans without the need for warm-starting. Moreover, we use soft-constraints to allow for increased flexibility when searching in the cost landscape of our problem. We showcase the performance of our trajectory optimization framework on multiple terrain conditions and validate our method in realistic simulation scenarios and experimental trials on a hydraulic, torque controlled quadruped robot.

  <a href="/publications/coupled17icra.pdf">
    <img src="/assets/img/download.png" alt="Drawing" style="height: 20px;"/>
  </a>
  <a href="/publications/bibtex/coupled17icra.bib">
    <img src="/assets/img/bibtex.jpeg" alt="Drawing" style="height: 20px;"/>
  </a>
  

  #### [Hierarchical Planning of Dynamic Movements without Scheduled Contact Sequences (ICRA)](/publications/hierarchical16icra.pdf)
  
  <iframe class="embed-responsive-item" allowfullscreen="allowfullscreen"
    width="420" height="237"
    src="https://youtube.com/embed/nfe_T04q2Ds"
    style="float: right; "
    marginwidth="10">
  </iframe>


  Most animal and human locomotion behaviors for solving complex tasks involve dynamic motions and rich contact interaction. In fact, complex maneuvers need to consider dynamic movement and contact events at the same time. We present a hierarchical trajectory optimization approach for planning dynamic movements with unscheduled contact sequences. We compute whole-body motions that achieve goals that cannot be reached in a kinematic fashion. First, we find a feasible CoM motion according to the centroidal dynamics of the robot. Then, we refine the solution by applying the robot's full-dynamics model, where the feasible CoM trajectory is used as a warm-start point. To accomplish the unscheduled contact behavior, we use complementarity constraints to describe the contact model, i.e. environment geometry and non-sliding active contacts. Both optimization phases are posed as Mathematical Program with Complementarity Constraints (MPCC). Experimental trials demonstrate the performance of our planning approach in a set of challenging tasks.

  <a href="/publications/hierarchical16icra.pdf">
    <img src="/assets/img/download.png" alt="Drawing" style="height: 20px;"/>
  </a>
  <a href="/publications/bibtex/hierarchical16icra.bib">
    <img src="/assets/img/bibtex.jpeg" alt="Drawing" style="height: 20px;"/>
  </a>


  
  #### [Planning and Execution of Dynamic Whole-Body Locomotion for a Hydraulic Quadruped on Challenging Terrain (ICRA)](/publications/locomotion15icra.pdf)
  
  <iframe class="embed-responsive-item" allowfullscreen="allowfullscreen"
    width="420" height="237"
    src="https://www.youtube.com/embed/MF-qxA_syZg"
    style="float: right; "
    marginwidth="10">
  </iframe>


  We present a framework for dynamic quadrupedal locomotion over challenging terrain, where the choice of appropriate footholds is crucial for the success of the behaviour. We build a model of the environment on-line and on-board using an efficient occupancy grid representation. We use Any-time-Repairing A* (ARA*) to search over a tree of possible actions, choose a rough body path and select the locally-best footholds accordingly. We run a n-step lookahead optimization of the body trajectory using a dynamic stability metric, the Zero Moment Point (ZMP), that generates natural dynamic whole-body motions. A combination of floating-base inverse dynamics and virtual model control accurately executes the desired motions on an actively compliant system. Experimental trials show that this framework allows us to traverse terrains at nearly 6 times the speed of our previous work, evaluated over the same set of trials.

  <a href="/publications/locomotion15icra.pdf">
    <img src="/assets/img/download.png" alt="Drawing" style="height: 20px;"/>
  </a>
  <a href="/publications/bibtex/locomotion15icra.bib">
    <img src="/assets/img/bibtex.jpeg" alt="Drawing" style="height: 20px;"/>
  </a>

#-------------------------------
# Work Section

projects:
- {name: 'Hierarchical Planning of Dynamic Movements without Scheduled Contact Sequences', folder: 'hierarchical', file: 'projects/hierarchical.html'}
- {name: 'Planning and Execution of Dynamic Whole-Body Locomotion for a Hydraulic Quadruped on Challenging Terrain', folder: 'decoupled', file: 'projects/decoupled.html'}


#-------------------------------
# Software Section

software: >
  ## Software
  
  #### [The Dynamic Whole-body Locomotion library (DWL)](https://github.com/robot-locomotion/dwl)
  
  <img src="https://i.imgur.com/4kKhryj.gif" align="right" alt="Drawing" style="height: 200px; margin:0px 10px;"/>
  <img src="/assets/img/software/dwl.png" align="right" alt="Drawing" style="height: 120px; margin:0px 0px;"/>
    

  The *Dynamic Whole-body Locomotion* library (DWL) implements a set of functionalities to develop, design, and deploy motion planning, control and perception algorithms for legged locomotion. DWL has different modules such as: kinematics, dynamics, solvers (tree-search, optimization, etc), and environment descriptions. All these tools are designed for both fast prototyping and deployment thanks to its c++ implementation and Python bindings. The DWL toolbox can be used in various software frameworks such as ROS and LCM, and for real-time control and planning.
  
  
  DWL was developed by Carlos Mastalli at [Dynamic Legged Systems lab (DLS)](http://www.iit.it/en/advr-labs/dynamic-legged-systems.html), Istituto Italiano di Tecnologia, Italy. The DWL is core toolbox used along of various software of the DLS lab at IIT.


  <span class="fa fa-github" aria-hidden="true" title="Github"></span>
  <a target="_blank" href="https://github.com/robot-locomotion/dwl" title="Github"> 
     https://github.com/robot-locomotion/dwl
  </a>


  #### [Whole-body state publisher](https://github.com/robot-locomotion/wb-state-publisher) [and visualization plugins of whole-body state, trajectories and terrain maps](https://github.com/robot-locomotion/dwl-rviz-plugin)

  <img src="https://i.imgur.com/TUrgkzO.gif" align="right" alt="Drawing" style="height: 220px; margin:0px 10px;"/>

  The wb_state_publisher is a ros controller that publishes the actual whole-body state of the robot. The whole-body state is described as ROS message (i.e. dwl_msgs/WholeBodyState) inside dwl_msgs. This message structure can be transformed to the dwl::WholeBodyState class which contains functions that allows us to get the robot state in the desired frame (e.g. world, base and horizontal). For using this ros control plugin, it is required to define a ros_control::JointStateInterface hardware interface.


  The dwl_rviz_plugin contains a set of tools and plugins for visualization of: the whole-body state of the robot (dwl_rviz_plugin::WholeBodyStateDisplay), the whole-body trajectory (dwl_rviz_plugin::WholeBodyTrajectoryDisplay), the terrain map (dwl_rviz_plugin::TerrainMapDisplay), the footstep regions (dwl_rviz_plugin::FootstepRegionDisplay), etc. These plugins subscribe to the standarized dwl messages (for more information see https://github.com/robot-locomotion/dwl-msgs).


  You can also have tools that allows us to create our custom plugin such as: points (dwl_rviz_plugin::PointVisual), lines (dwl_rviz_plugin::LineVisual), polygons (dwl_rviz_plugin::PolygonVisual), arrows (dwl_rviz_plugin::ArrowVisual), etc.


  <span class="fa fa-github" aria-hidden="true" title="Github"></span>
  <a target="_blank" href="https://github.com/robot-locomotion/wb-state-publisher" title="Github"> 
     https://github.com/robot-locomotion/wb-state-publisher
  </a>
  

  <span class="fa fa-github" aria-hidden="true" title="Github"></span>
  <a target="_blank" href="https://github.com/robot-locomotion/dwl-rviz-plugin" title="Github"> 
     https://github.com/robot-locomotion/dwl-rviz-plugin
  </a>



  #### [Terrain mapping algorithm for motion planning and control in legged locomotion](https://github.com/robot-locomotion/terrain-server)

  <img src="https://i.imgur.com/RKe3sNo.gif" align="right" alt="Drawing" style="height: 220px; margin:0px 10px;"/>

  The terrain server computes a risk associate to the terrain (i.e. terrain costmap) and its surface; information important for motion planning and control in legged locomotion. The terrain costmap quantifies how desirable it is to place a foot at a specific location. The cost value for each voxel in the map is computed using geometric terrain features such as height deviation, slope and curvature. It computes the slope and curvature through regression in a configurable window around the cell in question; the features are computed from a Octomap map. For instance, the estimated surface normals and curvatures are computed from a set of neighboring occupied voxels. It terrain servers is used in the different motion planning and control methods, see publication section.


  <span class="fa fa-github" aria-hidden="true" title="Github"></span>
  <a target="_blank" href="https://github.com/robot-locomotion/terrain-server" title="Github"> 
     https://github.com/robot-locomotion/terrain-server
  </a>



#-------------------------------
# Contact Section

contact: >
  ## Contact
  
  If you'd like to know more about my research or would just like to discuss past or future projects, feel free to contact me [by email](mailto:carlos.mastalli@gmail.com) or through [LinkedIn](https://www.linkedin.com/in/carlos-mastalli-27314118/).


social:
- {icon: 'github', link: 'https://github.com/cmastalli'}
- {icon: 'linkedin', link: 'https://www.linkedin.com/in/carlos-mastalli-27314118/'}
- {icon: 'youtube', link: 'https://www.youtube.com/channel/UCgC0AFO3J0454k3w0j5o3Vg?view_as=subscriber'}
- {icon: 'envelope', link: 'mailto:carlos.mastalli@gmail.com'}

# social network icons available: 'twitter' / 'facebook' / 'github' / 'pinterest' 'google-plus' / 'linkedin' / 'youtube' / 'instagram' / 'dribbble' / 'behance' / 'soundcloud' / 'vine'
